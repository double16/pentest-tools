#!/usr/bin/env /usr/bin/perl

# Converts a burp XML file to w3af CSV. Use the w3af importResource plugin with input_csv.

use MIME::Base64;

$url="";
$method="";
$postdata="";

while(<>) {
	if (m/<url><!\[CDATA\[(.*)\]\]><\/url>/) {
		$url = $1;
		$url =~ s/,/%2C/g;
	}
	if (m/<method>(.*)<\/method>/) {
		$method = $1;
	}
	if (m/<request base64="true"><!\[CDATA\[(.*)\]\]>/) {
		$postdata = decode_base64($1);
		$postdata =~ s/(.*\n)//sg;
		$postdata =~ s/,/%2C/g;

		print "$method,$url,$postdata\n";
		$url="";
		$method="";
		$postdata="";
	}
}


